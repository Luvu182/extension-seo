# SEO AI Assistant - Components Structure

## Mục đích Refactoring

Refactoring dự án SEO AI Assistant nhằm cải thiện:
- **Tính module hóa**: Chia nhỏ các thành phần để dễ bảo trì
- **Tái sử dụng**: Tạo các component có thể tái sử dụng
- **Hiệu suất**: Tối ưu hóa rendering với React.memo và hooks
- **Khả năng đọc hiểu**: Code rõ ràng, có comment đầy đủ
- **Khả năng mở rộng**: Dễ dàng thêm tính năng mới

## Cấu trúc thư mục mới

```
extension-main/
  ├── dist/                         # Compiled output (generated by webpack)
  ├── src/                          # Source code directory
  │   ├── background/               # Background script modules
  │   │   ├── controllers/          # Background controllers
  │   │   │   ├── message-controller.js      # Message dispatching
  │   │   │   ├── navigation-controller.js   # Tab/navigation events
  │   │   │   ├── web-request-controller.js  # HTTP requests
  │   │   │   ├── seo-data-controller.js     # SEO data management
  │   │   │   ├── spa-navigation-controller.js  # SPA detection
  │   │   │   ├── web-vitals-controller.js   # Web Vitals tracking
  │   │   │   ├── server-info-controller.js  # Server information
  │   │   │   ├── link-checker-controller.js # Link status checking
  │   │   │   └── tab-controller.js          # Tab management
  │   │   ├── services/             # Background services
  │   │   │   ├── cleanup-service.js         # Memory management
  │   │   │   ├── storage-service.js         # Data storage
  │   │   │   ├── web-vitals-service.js      # Web Vitals analysis
  │   │   │   ├── server-info-service.js     # Server details
  │   │   │   ├── link-checker-service.js    # Link status checking
  │   │   │   ├── vercel-link-service.js     # Optimized link checking API
  │   │   │   └── messaging-service.js       # Inter-component messaging
  │   │   └── background.js         # Main background entry point
  │   ├── content/                  # Content script modules
  │   │   ├── analyzers/            # Analysis modules
  │   │   ├── detectors/            # Detection modules
  │   │   ├── extractors/           # Data extraction
  │   │   ├── utils/                # Content utilities
  │   │   ├── content-controller.js # Content script controller
  │   │   └── content.js            # Main content entry point
  │   └── shared/                   # Shared utilities
  │       ├── utils/                # Utility modules
  │       │   ├── logger.js         # Enhanced logging
  │       │   └── messaging.js      # Message passing
  │       └── constants.js          # Shared constants
  ├── css/                          # CSS styles
  ├── images/                       # Icons and images
  ├── js/                           # JavaScript code
  │   ├── modules/                  # Modular JavaScript components
  │   │   ├── components/           # Reusable UI components
  │   │   │   ├── common/           # Common utility components
  │   │   │   │   ├── StatItem.js            # Component for statistics
  │   │   │   │   ├── RecommendationItem.js  # Component for recommendations
  │   │   │   │   ├── TabButton.js           # Tab navigation button
  │   │   │   │   ├── Card.js                # Card container
  │   │   │   │   ├── LoadingSpinner.js      # Loading indicator
  │   │   │   │   ├── ToggleSwitch.js        # Toggle switch component
  │   │   │   │   ├── StatusBadge.js         # Status indicator badge
  │   │   │   │   ├── ProgressBar.js         # Progress bar component
  │   │   │   │   ├── IconButton.js          # Button with icon
  │   │   │   │   └── EmptyState.js          # Empty state display
  │   │   │   ├── content/          # Content tab specific components
  │   │   │   │   ├── ContentTabHeader.js    # Tab navigation for content tab
  │   │   │   │   ├── TextContentTab.js      # Text content analysis tab
  │   │   │   │   ├── ImageContentTab.js     # Image content analysis tab
  │   │   │   │   ├── ImageIssueCard.js      # Image issues display
  │   │   │   │   ├── ImageTable.js          # Table for image data
  │   │   │   │   ├── ReadabilityScore.js    # Readability analysis
  │   │   │   │   ├── WordCount.js           # Word count component
  │   │   │   │   ├── ContentStats.js        # Content statistics
  │   │   │   │   └── MetaInfoDisplay.js     # Meta information display
  │   │   │   ├── links/            # Links tab components
  │   │   │   │   ├── LinkCountCards.js     # Link count cards component
  │   │   │   │   ├── LinkDistribution.js   # Link distribution chart component
  │   │   │   │   ├── LinkAnalysisTable.js  # Link analysis table component
  │   │   │   │   ├── LinkStatusChecker.js  # Link status checker component
  │   │   │   │   ├── LinkTable.js          # Link table component
  │   │   │   │   ├── LinkExportButton.js   # Link export button component
  │   │   │   │   ├── LinkIssuesTable.js    # Link issues table component
  │   │   │   │   └── LinkStatusFilter.js   # Link status filter component
  │   │   │   ├── overview/         # Overview tab components
  │   │   │   │   ├── WebsiteInformation.js  # Website info component
  │   │   │   │   ├── SeoScoreCard.js        # SEO score card component
  │   │   │   │   ├── CoreWebVitals.js       # Core Web Vitals display
  │   │   │   │   ├── ServerDetails.js       # Server details component
  │   │   │   │   ├── ResponseDetails.js     # Response details component
  │   │   │   │   ├── ContentOverview.js     # Content overview component
  │   │   │   │   ├── IssuesSummary.js       # Issues summary component
  │   │   │   │   └── OpenGraphTags.js       # Open Graph tags component
  │   │   │   ├── performance/      # Performance tab components
  │   │   │   │   ├── MetricItem.js          # Performance metric item
  │   │   │   │   ├── PerformanceScoreCard.js # Performance score card
  │   │   │   │   ├── CoreWebVitalsDetail.js # Detailed Core Web Vitals
  │   │   │   │   ├── ServerResponseTime.js  # TTFB component
  │   │   │   │   └── PerformanceRecommendations.js # Performance recommendations
  │   │   │   ├── structured/       # Structured data tab components
  │   │   │   │   ├── SchemaDisplay.js       # Schema markup display
  │   │   │   │   ├── SchemaValidator.js     # Schema validation component
  │   │   │   │   └── SchemaTree.js          # Tree view for schema
  │   │   │   ├── issues/           # Issues tab components
  │   │   │   │   ├── IssuesList.js          # List of SEO issues
  │   │   │   │   ├── IssueCard.js           # Individual issue card
  │   │   │   │   └── IssuePriority.js       # Issue priority component
  │   │   │   ├── ai/               # AI tab components
  │   │   │   │   ├── AiSuggestions.js       # AI suggestions display
  │   │   │   │   ├── ApiKeyInput.js         # API key input form
  │   │   │   │   └── AiPromptForm.js        # AI prompt form component
  │   │   │   ├── settings/         # Settings components
  │   │   │   │   ├── SettingsForm.js        # Settings form component
  │   │   │   │   ├── ApiKeyManager.js       # API key management
  │   │   │   │   └── FeatureToggle.js       # Feature toggle component
  │   │   │   ├── App.js            # Main app component
  │   │   │   ├── Header.js         # Header component
  │   │   │   ├── SerpPreview.js    # SERP preview component
  │   │   │   ├── NavTabs.js        # Navigation tabs component
  │   │   │   ├── Footer.js         # Footer component
  │   │   │   └── HeadingStructure.js # Heading structure component
  │   │   ├── services/             # Business logic services
  │   │   │   ├── data-fetching-service.js # Data fetching service
  │   │   │   ├── navigation-service.js    # Navigation and tab switching
  │   │   │   ├── server-service.js        # Server details service
  │   │   │   ├── performance-service.js   # Performance metrics service
  │   │   │   ├── content-analysis-service.js # Content analysis service
  │   │   │   ├── image-analysis-service.js # Image analysis service
  │   │   │   ├── link-service.js          # Link status and export service
  │   │   │   ├── schema-service.js        # Schema analysis service
  │   │   │   ├── ai-service.js            # AI integration service
  │   │   │   └── settings-service.js      # Settings management service
  │   │   ├── tabs/                 # Tab-specific modules
  │   │   │   ├── overview-tab.js      # Overview tab component
  │   │   │   ├── structured-tab.js    # Structured data tab component
  │   │   │   ├── links-tab.js         # Links tab component
  │   │   │   ├── performance-tab.js   # Performance tab component
  │   │   │   ├── content-tab.js       # Content tab component (refactored)
  │   │   │   ├── issues-tab.js        # Issues tab component
  │   │   │   ├── ai-tab.js            # AI tab component
  │   │   │   └── settings-tab.js      # Settings tab component
  │   │   ├── data-service.js       # Data processing service
  │   │   ├── store.js              # State management
  │   │   ├── styles.js             # UI styles
  │   │   └── utils.js              # Utility functions
  │   ├── lib/                      # Third-party libraries
  │   ├── background.js             # Background script entry point
  │   ├── content.js                # Content script entry point
  │   └── popup.js                  # Popup script entry point
  ├── manifest.json                 # Extension manifest
  ├── popup.html                    # Popup HTML
  ├── webpack.config.cjs            # Webpack configuration
  ├── package.json                  # NPM package configuration
  ├── README.md                     # Project documentation
  ├── CHANGELOG.md                  # Release history
  ├── REFACTORING-GUIDE.md          # Guide for ongoing refactoring
  └── COMPONENT-STRUCTURE.md        # Component structure documentation (this file)
```

## Chi tiết Components

### 1. Common Components

#### StatItem
- **File:** `js/modules/components/common/StatItem.js`
- **Mục đích:** Hiển thị một mục thống kê với label, giá trị và màu sắc tùy chọn
- **Props:**
  - `label`: Nhãn cho mục thống kê
  - `value`: Giá trị hiển thị
  - `indicatorColor`: Màu sắc chỉ báo (tùy chọn)

#### RecommendationItem
- **File:** `js/modules/components/common/RecommendationItem.js`
- **Mục đích:** Hiển thị một khuyến nghị SEO với mức độ ưu tiên
- **Props:**
  - `title`: Tiêu đề khuyến nghị
  - `description`: Mô tả chi tiết
  - `priority`: Mức độ ưu tiên ('high', 'medium', 'low')

### 2. Content Tab Components

#### ContentTabHeader
- **File:** `js/modules/components/content/ContentTabHeader.js`
- **Mục đích:** Hiển thị tab navigation để chuyển đổi giữa Text/Image
- **Props:**
  - `activeContentTab`: Tab hiện tại
  - `handleTabChange`: Hàm xử lý khi tab thay đổi

#### TextContentTab
- **File:** `js/modules/components/content/TextContentTab.js`
- **Mục đích:** Hiển thị phân tích nội dung văn bản
- **Props:**
  - `data`: Dữ liệu trang cần phân tích

#### ImageContentTab
- **File:** `js/modules/components/content/ImageContentTab.js`
- **Mục đích:** Hiển thị phân tích nội dung hình ảnh
- **Props:**
  - `data`: Dữ liệu trang cần phân tích
  - `includeHeaderFooter`: Boolean để xác định có hiển thị hình ảnh ở header/footer
  - `toggleHeaderFooter`: Hàm xử lý khi toggle includeHeaderFooter

#### ImageIssueCard
- **File:** `js/modules/components/content/ImageIssueCard.js`
- **Mục đích:** Hiển thị thông tin về các vấn đề liên quan đến hình ảnh
- **Props:**
  - `issueType`: Loại vấn đề ('missing-alt' hoặc 'non-optimized-filename')
  - `count`: Số lượng hình ảnh bị ảnh hưởng
  - `images`: Mẫu hình ảnh có vấn đề (tối đa 3)
  - `totalCount`: Tổng số hình ảnh bị ảnh hưởng

#### ImageTable
- **File:** `js/modules/components/content/ImageTable.js`
- **Mục đích:** Hiển thị bảng chi tiết về các hình ảnh
- **Props:**
  - `images`: Mảng các đối tượng hình ảnh

### 3. Main Tab Component

#### ContentTab
- **File:** `js/modules/tabs/content-tab.js`
- **Mục đích:** Component chính cho tab Content, điều phối các component con
- **Props:**
  - `pageData`: Dữ liệu SEO của trang hiện tại

### 4. Service

#### ImageAnalysisService
- **File:** `js/modules/tabs/content-tab.js` (sẽ chuyển sang `js/modules/services/image-analysis-service.js` trong tương lai)
- **Mục đích:** Dịch vụ phân tích hình ảnh, trích xuất dữ liệu
- **Methods:**
  - `getImages(pageData)`: Trích xuất hình ảnh từ dữ liệu trang
  - `getImageRecommendations(images)`: Tạo các khuyến nghị cho hình ảnh
  - `getImageStats(pageData, includeHeaderFooter)`: Lấy thống kê hình ảnh

## Cách dùng Components

### Sử dụng ContentTab trong popup.js hoặc các file khác:

```javascript
import { ContentTab } from './modules/tabs/content-tab.js';

// Trong phương thức render của component chính
render() {
    return React.createElement('div', { className: 'tabs-container' },
        React.createElement('div', { className: 'tab-content' },
            this.state.activeTab === 'content' && React.createElement(ContentTab, {
                pageData: this.state.pageData
            })
        )
    );
}
```

### Mở rộng ContentTab với tính năng mới:

1. Tạo component mới trong thư mục thích hợp
2. Import và sử dụng trong ContentTab hoặc các component con của nó
3. Cập nhật logic phân tích trong ImageAnalysisService nếu cần

## Quy tắc phát triển

1. **Một Component, Một Nhiệm Vụ**: Mỗi component chỉ nên thực hiện một nhiệm vụ cụ thể
2. **Sử dụng React.memo**: Memoize tất cả các component để tránh re-renders không cần thiết
3. **Tách Logic và UI**: Tách logic xử lý dữ liệu vào services, UI thuần túy trong components
4. **Props Validation**: Có JSDoc đầy đủ cho props của mọi component
5. **Mã Sạch**: Đặt tên biến, hàm rõ ràng; dùng camelCase cho hàm/biến, PascalCase cho component

## Hướng phát triển tiếp theo

1. Tách ImageAnalysisService thành file riêng trong thư mục services
2. Thêm tính năng readability score trong TextContentTab
3. Cải thiện phân tích keyword density
4. Thêm tính năng kiểm tra WAI-ARIA cho phần image accessibility
5. Tối ưu hóa performance với React.useCallback và React.useMemo
